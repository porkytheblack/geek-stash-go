FROM golang:1.16-alpine 

WORKDIR /app


COPY . .

ENV AUTH0_SECRET=${AUTH0_SECRET}
ENV AUTH0_BASE_URL=${AUTH0_BASE_URL}
ENV AUTH0_ISSUER_BASE_URL=${AUTH0_ISSUER_BASE_URL}
ENV AUTH0_CLIENT_ID=${AUTH0_CLIENT_ID}
ENV AUTH0_CLIENT_SECRET=${AUTH0_CLIENT_SECRET}
ENV XAUTHKEY=${XAUTHKEY}
ENV DB_HOST=${DB_HOST}
ENV DB_PORT=${DB_PORT}
ENV DB_USER=${DB_USER}
ENV DB_PASS=${DB_PASS}
ENV DB_NAME=${DB_NAME}
ENV DB_SSLMODE=${DB_SSLMODE}
ENV GO_ENV=${GO_ENV}

RUN echo ${AUTH0_BASE_URL} ${AUTH0_ISSUER_BASE_URL} ${AUTH0_CLIENT_ID} ${AUTH0_CLIENT_SECRET} ${XAUTHKEY} ${DB_HOST} ${DB_PORT} ${DB_USER} ${DB_PASS} ${DB_NAME} ${DB_SSLMODE} ${GO_ENV}


RUN go build -o main

CMD ["./main"]